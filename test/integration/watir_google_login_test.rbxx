require 'watir'
require 'minitest/autorun'

class WatirMainTest < ActionDispatch::IntegrationTest


    setup do #before each test
        # put --headless in the switches to avoid showing pages
        system("fuser -k 3000/tcp")
        system("rails s -d -p 3000")
        @b = Watir::Browser.new :chrome, :switches => %w{ :headless }
        @b.goto 'http://localhost:3000'
        @b.wait
        @b.wait_until { @b.text.include? "Login" }

    end

    teardown do #after each test
        @b.close
        system("fuser -k 3000/tcp")
    end




end
